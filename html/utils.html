<script>
    const asyncGAPIv2 = ({
        funcName,
        onFailure = console.error,
        onSuccess,
        params = []
    }) => {

        console.log(funcName, params);

        return new Promise((res, rej) => {
            google.script.run
                .withSuccessHandler(data => {
                    typeof onSuccess === "function" && onSuccess(data);
                    res(data);
                })
                .withFailureHandler(error => {
                    typeof onFailure === "function" && onFailure(error);
                    rej(error);
                })
            [funcName].apply(null, params);
        });
    };

    const buildTime = ({
        hours = 0,
        minutes = 0
    } = {}) => {
        const over = minutes > 59 ? Math.floor(minutes / 60) || 1 : 0;

        const hh = hours + over;

        const mm = over ? minutes - (over * 60) : minutes;

        return `${hh < 10 ? `0${hh}` : hh}:${mm < 10 ? `0${mm}` : mm}`;
    };
</script>